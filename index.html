<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Magic Ductwork</title>
    <link rel="stylesheet" href="css/style.css">
    <script src="js/libs/CSInterface.js"></script>
    <script src="js/panel.js" defer></script>
</head>
<body>
    <main class="card-grid">

    <section class="card">
        <h2>Run Ductwork Generator</h2>
        <p class="muted">Configure ductwork options, process the selection, or restore stored geometry.</p>

        <div class="option-group">
            <label class="option-row">
                <input type="checkbox" id="skip-ortho-option">
                <span>Skip orthogonalization (<code>MD:NO_ORTHO</code>)</span>
            </label>

            <div class="option-row inline">
                <label for="rotation-input">Rotation override (°):</label>
                <input type="text" id="rotation-input" class="rotation-input" placeholder="auto" inputmode="decimal">
                <button type="button" id="clear-rotation-btn" class="ghost sm">Clear</button>
            </div>

            <label class="option-row">
                <input type="checkbox" id="skip-all-branches-option">
                <span>Skip orthogonalizing all branch segments</span>
            </label>

            <label class="option-row">
                <input type="checkbox" id="skip-final-option">
                <span>Skip orthogonalizing final segment into registers</span>
            </label>

            <label class="option-row" id="create-register-wires-row">
                <input type="checkbox" id="create-register-wires-option">
                <span>Create Register Wires</span>
            </label>
        </div>

        <div class="button-row">
            <button id="process-btn" class="primary">Process Ductwork</button>
            <button id="process-emory-btn" class="primary">Process Ductwork Emory</button>
        </div>
        <div class="button-row">
            <button id="revert-ortho-btn" class="secondary">Revert Pre-Ortho</button>
            <button id="clear-rotation-metadata-btn" class="secondary">Clear Rotation Metadata</button>
        </div>
        <p id="process-status" class="status"></p>
        <p id="revert-status" class="status"></p>
        <p id="clear-rotation-metadata-status" class="status"></p>
    </section>

    <section class="card">
        <h2>Transform Each</h2>
        <p class="muted">Scale and rotate each selected object individually.</p>

        <div class="control-group" style="margin-bottom: 10px;">
            <div class="option-row inline" style="justify-content: space-between; margin-bottom: 5px;">
                <label for="te-scale">Scale (%):</label>
                <input type="number" id="te-scale" value="100" step="1" style="width: 60px;">
            </div>
            <input type="range" id="te-scale-slider" min="10" max="400" value="100" style="width: 100%;">
        </div>

        <div class="control-group" style="margin-bottom: 15px;">
            <div class="option-row inline" style="justify-content: space-between; margin-bottom: 5px;">
                <label for="te-rotate">Rotate (°):</label>
                <input type="number" id="te-rotate" value="0" step="1" style="width: 60px;">
            </div>
            <input type="range" id="te-rotate-slider" min="-180" max="180" value="0" style="width: 100%;">
        </div>
        
        <div class="option-row">
            <input type="checkbox" id="te-live-option" checked>
            <span>Live Preview</span>
        </div>

        <div class="button-row">
            <button id="transform-each-btn" class="primary">Apply / Reset</button>
            <button id="te-reset-original-btn" class="secondary">Reset to Original</button>
        </div>
        
        <hr class="separator">
        
        <h3>Quick Rotate</h3>
        <div class="button-row wrap">
            <button id="rotate-90-btn" class="secondary">Rotate 90°</button>
            <button id="rotate-45-btn" class="secondary">Rotate 45°</button>
            <button id="rotate-180-btn" class="secondary">Rotate 180°</button>
        </div>

        <p id="selection-status" class="status"></p>
    </section>

    <section class="card">
        <h2>Layer Management</h2>
        <p class="muted">Quick isolation tools for ductwork layers.</p>
        <div class="layer-button-container">
            <div class="layer-buttons-left">
                <button id="isolate-parts-btn" class="secondary">Isolate Ductwork Parts</button>
                <button id="isolate-lines-btn" class="secondary">Isolate Ductwork Lines</button>
                <button id="create-layers-btn" class="success">Create Standard Layers</button>
                <button id="import-styles-btn" class="success">Import Graphic Styles</button>
            </div>
            <div class="layer-buttons-right">
                <button id="unlock-ductwork-btn" class="ghost"><img src="button_images/Unlock All Ductwork Layers.png" alt="">Unlock All Ductwork Layers</button>
            </div>
        </div>
        <p id="layer-status" class="status"></p>
        <p id="import-status" class="status"></p>
    </section>

    <section class="card">
        <h2>Export Tools</h2>
        <p class="muted">Export ductwork and floorplans to PNG.</p>
        <div class="button-row">
            <button id="export-ductwork-btn" class="primary">Export Ductwork</button>
            <button id="reexport-floorplan-btn" class="secondary">Re-Export Floorplan</button>
        </div>
        <p id="export-status" class="status"></p>
    </section>

    </main>
    <footer>
        <button id="reload-btn" class="ghost">Reload Extension (F5)</button>
        <span id="debug-status"></span>
    </footer>
</body>
</html>
