<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Magic Ductwork</title>
    <link rel="stylesheet" href="css/style.css">
    <script src="js/libs/CSInterface.js"></script>
    <script src="js/panel.js" defer></script>
</head>
<body>
    <header>
        <h1>Magic Ductwork</h1>
        <p class="subtitle">Illustrator ductwork automation &amp; register ignore helper</p>
    </header>

    <section class="card">
        <h2>Run Ductwork Generator</h2>
        <p>Configure key Magic Ductwork options, then process the current Illustrator document or restore stored geometry.</p>

        <div class="option-group">
            <label class="option-row">
                <input type="checkbox" id="skip-ortho-option">
                <span>Skip orthogonalization (<code>MD:NO_ORTHO</code>)</span>
            </label>

            <div class="option-row">
                <label for="rotation-input">Rotation override (degrees):</label>
                <input type="number" id="rotation-input" placeholder="Leave blank to skip" step="0.01">
                <button type="button" id="clear-rotation-btn" class="ghost sm">Clear</button>
            </div>

            <label class="option-row">
                <input type="checkbox" id="skip-final-option">
                <span>Skip orthogonalizing final segment into registers</span>
            </label>
        </div>

        <div class="button-row">
            <button id="process-btn" class="primary">Process Ductwork</button>
            <button id="revert-ortho-btn" class="secondary">Revert Pre-Ortho</button>
        </div>
        <p id="process-status" class="status"></p>
        <p id="revert-status" class="status"></p>
    </section>

    <section class="card">
        <h2>Selection Transform</h2>
        <p>Rotate or scale the current selection. Rotation applies to units/registers; scaling updates units/registers/thermostats and ductwork stroke widths.</p>

        <div class="button-row wrap">
            <button id="rotate-90-btn" class="secondary">Rotate 90째</button>
            <button id="rotate-45-btn" class="secondary">Rotate 45째</button>
            <button id="rotate-180-btn" class="secondary">Rotate 180째</button>
        </div>

        <div class="custom-rotation">
            <label for="custom-rotation-input">Custom rotation (째):</label>
            <input type="number" id="custom-rotation-input" placeholder="e.g. 12.5" step="0.1">
            <button id="rotate-custom-btn" class="accent">Apply</button>
        </div>

        <div class="scale-control">
            <div class="scale-header">
                <label for="scale-slider">Scale selection</label>
                <span id="scale-label">100%</span>
            </div>
            <input type="range" id="scale-slider" min="25" max="200" value="100">

            <div class="custom-rotation">
                <label for="scale-input">Custom scale (%):</label>
                <input type="number" id="scale-input" placeholder="e.g. 150" min="25" max="500" step="1">
                <button id="apply-scale-btn" class="accent">Apply</button>
            </div>

            <div class="button-row wrap">
                <button id="reset-scale-btn" class="ghost">Reset Scale</button>
            </div>
        </div>

        <p id="selection-status" class="status"></p>
    </section>

    <section class="card">
        <h2>Layer Management</h2>
        <p>Quickly isolate ductwork elements or restore standard visibility locks.</p>
        <div class="button-row wrap">
            <button id="isolate-parts-btn" class="secondary">Isolate Ductwork Parts</button>
            <button id="isolate-lines-btn" class="secondary">Isolate Ductwork Lines</button>
            <button id="unlock-ductwork-btn" class="ghost">Unlock All Ductwork Layers</button>
            <button id="create-layers-btn" class="secondary">Create Standard Layers</button>
        </div>
        <p id="layer-status" class="status"></p>
    </section>

    <section class="card">
        <h2>Utilities</h2>
        <p>Import ductwork graphic styles without keeping the reference artwork.</p>
        <div class="button-row">
            <button id="import-styles-btn" class="secondary">Import Graphic Styles</button>
        </div>
        <p id="import-status" class="status"></p>
    </section>

    <section class="card">
        <h2>Register Ignore Utility</h2>
        <p>Create ignore markers on the Ignore layer for each selected open duct line.</p>
        <div class="button-row">
            <button id="apply-ignore-btn" class="accent">Apply Ignore to Selection</button>
        </div>
        <p id="ignore-status" class="status"></p>
    </section>

    <footer>
        <button id="reload-btn" class="ghost">Reload Panel</button>
        <span id="debug-status"></span>
    </footer>
</body>
</html>
